<% layout('layouts/boilerplate.ejs') %>
<div id="cluster-map"></div>
<div class="container mt-5">
  <h1 class="mb-5">All Campgrounds</h1>

  <!-- Nav -->
  <a class="btn btn-success mb-5" href="/campgrounds/new"
    >Create a New Campground</a
  >
  <a class="btn btn-dark mb-5" href="/">Back to Home</a>

  <div class="camps">
    <% for (let campground of campgrounds){%>
    <div id="card-index" class="card mb-3">
      <div class="row">
        <div>
          <% if(campground.images.length) {%>
          <img
            class="img-fluid img-thumbnail"
            alt="campground"
            src="<%=campground.images[0].url%> "
            style="min-width: 300px; max-height: 200px"
            crossorigin="anonymous"
          />
          <% } else {%>

          <img
            class="img-fluid img-thumbnail"
            alt="campground"
            src=" https://res.cloudinary.com/marlonmelo/image/upload/v1646247986/YelpCamp/siubdsmkz0efoybjtlyg.jpg"
            style="max-width: 300px; max-height: 200px"
            crossorigin="anonymous"
          />
          <% } %>
        </div>
        <div>
          <div class="card-body">
            <h5 class="card-title"><%=campground.title %></h5>
            <p class="card-text">
              <%=campground.description.substring(0,50)%> ...
            </p>
            <p class="text-muted"><%=campground.location%></p>
            <a class="btn btn-primary" href="/campgrounds/<%=campground._id%> "
              >View <%=campground.title.substring(0,20)%> ...</a
            >
          </div>
        </div>
      </div>
    </div>

    <%}%>
  </div>
</div>

<!-- Script to config the access token for MapBox -->
<script crossorigin="anonymous">
  const mapToken = "<%-process.env.MAPBOX_TOKEN%>";
  const campgrounds = {features: <%-JSON.stringify(campgrounds)%>}
</script>

<script src="/js/clusterMap.js" crossorigin="anonymous"></script>
